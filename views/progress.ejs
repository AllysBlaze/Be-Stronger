<%- include('header.ejs') %>

<body>
    <%- include('sideBarMenu.ejs') %>
    <div id="main">
        <button class="btn btn-outline-dark openbtn" onclick="openNav()">&#9776; Menu</button>
        <script src="https://cdn.plot.ly/plotly-2.4.2.min.js"></script>
        <div class="container-fluid">
            <div class="col-lg-9 mx-auto">
                <div class="row text-center">
                    <h1>Miesięczne podsumowanie aktywności</h1>
                </div>
                <div class="row text-center">
                    <div class="col mx-0">
                        <div id="pie" class="m-2"></div>
                    </div>
                    <div class="col mx-0">
                        <div id="bar" class="m-2"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>
        var layoutPie = { // zmiana rozmiaru wykresu
            height: 400,
            width: 500
        };
        pieChart = document.getElementById('pie');
        const x1 = "<%= x1 %>".split(',')
        const y1 = "<%= y1 %>".split(',')
        var d = [{
            values: y1,
            labels: x1,
            type: 'pie'
        }]

        Plotly.newPlot(pieChart, d, layoutPie);



        barChart = document.getElementById('bar');
        const x2 = "<%= x2 %>".split(',').map(function (item) {
            return parseInt(item, 10);
        });
        const y2 = "<%= y2 %>".split(',').map(function (item) {
            return parseInt(item, 10);
        });
        const labels = "<%= labels %>".split(',').map(time => '2020-01-08 ' + time);
        const goal = "2020-01-08 " + "<%= goal %>"

        const goals = []
        for (var i = 0; i < x2.length; i++) {
            goals.push(goal)
        }
        var layoutBar = {
            height: 400,
            width: 500,
            yaxis: {
                tickformat: '%H:%M:%S',
            },
            xaxis: {
                dtick: 1
            },
            legend: {
                "orientation": "h"
            }
        };
        Plotly.newPlot(barChart, [{
                x: x2,
                y: labels,
                name: 'zapisane aktywności',
                type: 'bar'
            },
            {
                x: x2,
                y: goals,
                name: 'Tygodniowy cel',
                type: 'scatter'
            }
        ], layoutBar)
    </script>
    </div>
    <%- include('footer.ejs') %>
</body>

</html>